
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Spatial weights in PySAL Â· Geographic Data Science with PySAL and the pydata stack</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex-dev/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="04_esda.html" />
    
    
    <link rel="prev" href="02_geovisualization.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../distribution.html">
            
                <a href="../distribution.html">
            
                    
                    Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../content/about.html">
            
                <a href="../content/about.html">
            
                    
                    About the authors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../content/infrastructure/">
            
                <a href="../content/infrastructure/">
            
                    
                    Install guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../content/outline.html">
            
                <a href="../content/outline.html">
            
                    
                    Outline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../content/data/">
            
                <a href="../content/data/">
            
                    
                    Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../content/part1/">
            
                <a href="../content/part1/">
            
                    
                    Part I
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="01_data_processing.html">
            
                <a href="01_data_processing.html">
            
                    
                    Spatial data processing with PySAL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="02_geovisualization.html">
            
                <a href="02_geovisualization.html">
            
                    
                    Geovisualization
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.7.3" data-path="03_spatial_weights.html">
            
                <a href="03_spatial_weights.html">
            
                    
                    Spatial weights in PySAL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="04_esda.html">
            
                <a href="04_esda.html">
            
                    
                    ESDA with PySAL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="05_spatial_dynamics.html">
            
                <a href="05_spatial_dynamics.html">
            
                    
                    Space-time analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../content/part2/">
            
                <a href="../content/part2/">
            
                    
                    Part II
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="06_points.html">
            
                <a href="06_points.html">
            
                    
                    Points
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="07_spatial_clustering.html">
            
                <a href="07_spatial_clustering.html">
            
                    
                    Spatial clustering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="08_spatial_regression.html">
            
                <a href="08_spatial_regression.html">
            
                    
                    Spatial Regression
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../content/infrastructure/workflow.html">
            
                <a href="../content/infrastructure/workflow.html">
            
                    
                    Development notes
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Spatial weights in PySAL</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="spatial-weights">Spatial Weights</h1>
<blockquote>
<p><a href="../content/part1/03_spatial_weights.ipynb"><code>IPYNB</code></a></p>
</blockquote>
<p>Spatial weights are mathematical structures used to represent spatial relationships. Many spatial analytics, such as spatial autocorrelation statistics and regionalization algorithms rely on spatial weights. Generally speaking, a spatial weight $w_{i,j}$ expresses the notion of a geographical relationship between locations $i$ and $j$. These relationships can be based on a number of criteria including contiguity, geospatial distance and general distances.</p>
<p>PySAL offers functionality for the construction, manipulation, analysis, and conversion of a wide array of spatial weights.</p>
<p>We begin with construction of weights from common spatial data formats.</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pysal <span class="hljs-keyword">as</span> ps
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> libpysal <span class="hljs-keyword">as</span> lps
<span class="hljs-keyword">from</span> libpysal.weights <span class="hljs-keyword">import</span> Queen, Rook, KNN, Kernel, DistanceBand,w_difference
<span class="hljs-keyword">from</span> libpysal.weights <span class="hljs-keyword">import</span> min_threshold_dist_from_shapefile
<span class="hljs-keyword">from</span> splot.libpysal <span class="hljs-keyword">import</span> plot_spatial_weights
</code></pre>
<p>There are functions to construct weights directly from a file path. </p>
<pre><code class="lang-python">shp_path = <span class="hljs-string">&quot;data/texas.shp&quot;</span>
</code></pre>
<h2 id="weight-types">Weight Types</h2>
<h3 id="contiguity">Contiguity:</h3>
<h4 id="queen-weights">Queen Weights</h4>
<p>A commonly-used type of weight is a queen contigutiy weight, which reflects adjacency relationships as a binary indicator variable denoting whether or not a polygon shares an edge or a vertex with another polygon. These weights are symmetric, in that when polygon $A$ neighbors polygon $B$, both $w<em>{AB} = 1$ and $w</em>{BA} = 1$.</p>
<p>To construct queen weights from a shapefile, use the <code>queen_from_shapefile</code> function:</p>
<pre><code class="lang-python">shp_path = <span class="hljs-string">&quot;data/texas.shp&quot;</span>
gpd_df = gpd.read_file(shp_path)
qW = Queen.from_dataframe(gpd_df)
</code></pre>
<pre><code class="lang-python">qW
</code></pre>
<pre><code>&lt;libpysal.weights.contiguity.Queen at 0x7fea4dfb36a0&gt;
</code></pre><p>All weights objects have a few traits that you can use to work with the weights object, as well as to get information about the weights object. </p>
<p>To get the neighbors &amp; weights around an observation, use the observation&apos;s index on the weights object, like a dictionary:</p>
<pre><code class="lang-python">qW[<span class="hljs-number">4</span>] <span class="hljs-comment">#neighbors &amp; weights of the 5th observation (0-index remember)</span>
</code></pre>
<pre><code>{0: 1.0, 3: 1.0, 5: 1.0, 6: 1.0, 7: 1.0}
</code></pre><p>By default, the weights and the pandas dataframe will use the same index. So, we can view the observation and its neighbors in the dataframe by putting the observation&apos;s index and its neighbors&apos; indexes together in one list:</p>
<pre><code class="lang-python">self_and_neighbors = [<span class="hljs-number">4</span>]
self_and_neighbors.extend(qW.neighbors[<span class="hljs-number">4</span>])
print(self_and_neighbors)
</code></pre>
<pre><code>[4, 0, 3, 5, 6, 7]
</code></pre><p>and grabbing those elements from the dataframe:</p>
<pre><code class="lang-python">gpd_df.loc[self_and_neighbors]
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>STATE_NAME</th>
      <th>STATE_FIPS</th>
      <th>CNTY_FIPS</th>
      <th>FIPS</th>
      <th>STFIPS</th>
      <th>COFIPS</th>
      <th>FIPSNO</th>
      <th>SOUTH</th>
      <th>HR60</th>
      <th>...</th>
      <th>BLK90</th>
      <th>GI59</th>
      <th>GI69</th>
      <th>GI79</th>
      <th>GI89</th>
      <th>FH60</th>
      <th>FH70</th>
      <th>FH80</th>
      <th>FH90</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91efd0&gt;</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Lipscomb</td>
      <td>Texas</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.031817</td>
      <td>0.286929</td>
      <td>0.378219</td>
      <td>0.407005</td>
      <td>0.373005</td>
      <td>6.724512</td>
      <td>4.5</td>
      <td>3.835360</td>
      <td>6.093580</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee10&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hansford</td>
      <td>Texas</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.253527</td>
      <td>0.357813</td>
      <td>0.393938</td>
      <td>0.383924</td>
      <td>7.591786</td>
      <td>4.7</td>
      <td>5.542986</td>
      <td>7.125457</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ef60&gt;</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Roberts</td>
      <td>Texas</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.320275</td>
      <td>0.318656</td>
      <td>0.398681</td>
      <td>0.339626</td>
      <td>5.762712</td>
      <td>5.3</td>
      <td>6.231454</td>
      <td>4.885993</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b080&gt;</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hemphill</td>
      <td>Texas</td>
      <td>48</td>
      <td>211</td>
      <td>48211</td>
      <td>48</td>
      <td>211</td>
      <td>48211</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.188172</td>
      <td>0.286707</td>
      <td>0.385605</td>
      <td>0.352996</td>
      <td>0.346318</td>
      <td>6.300115</td>
      <td>6.9</td>
      <td>6.451613</td>
      <td>6.330366</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b0f0&gt;</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Hutchinson</td>
      <td>Texas</td>
      <td>48</td>
      <td>233</td>
      <td>48233</td>
      <td>48</td>
      <td>233</td>
      <td>48233</td>
      <td>1</td>
      <td>1.936915</td>
      <td>...</td>
      <td>2.635369</td>
      <td>0.199287</td>
      <td>0.322579</td>
      <td>0.323864</td>
      <td>0.370207</td>
      <td>5.387316</td>
      <td>5.1</td>
      <td>6.222679</td>
      <td>8.484271</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b160&gt;</td>
    </tr>
  </tbody>
</table>
<p>6 rows &#xD7; 70 columns</p>
</div>



<p>A full, dense matrix describing all of the pairwise relationships is constructed using the <code>.full</code> method, or when <code>pysal.full</code> is called on a weights object:</p>
<pre><code class="lang-python">Wmatrix, ids = qW.full()
</code></pre>
<pre><code class="lang-python">Wmatrix
</code></pre>
<pre><code>array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  1., ...,  0.,  0.,  0.],
       [ 0.,  1.,  0., ...,  0.,  0.,  0.],
       ..., 
       [ 0.,  0.,  0., ...,  0.,  1.,  1.],
       [ 0.,  0.,  0., ...,  1.,  0.,  1.],
       [ 0.,  0.,  0., ...,  1.,  1.,  0.]])
</code></pre><pre><code class="lang-python">n_neighbors = Wmatrix.sum(axis=<span class="hljs-number">1</span>) <span class="hljs-comment"># how many neighbors each region has</span>
</code></pre>
<pre><code class="lang-python">n_neighbors[<span class="hljs-number">4</span>]
</code></pre>
<pre><code>5.0
</code></pre><pre><code class="lang-python">qW.cardinalities[<span class="hljs-number">4</span>]
</code></pre>
<pre><code>5
</code></pre><p>Note that this matrix is binary, in that its elements are either zero or one, since an observation is either a neighbor or it is not a neighbor. </p>
<p>However, many common use cases of spatial weights require that the matrix is row-standardized. This is done simply in PySAL using the <code>.transform</code> attribute</p>
<pre><code class="lang-python">qW.transform = <span class="hljs-string">&apos;r&apos;</span>
</code></pre>
<p>Now, if we build a new full matrix, its rows should sum to one:</p>
<pre><code class="lang-python">Wmatrix, ids = qW.full()
</code></pre>
<pre><code class="lang-python">Wmatrix.sum(axis=<span class="hljs-number">1</span>) <span class="hljs-comment">#numpy axes are 0:column, 1:row, 2:facet, into higher dimensions</span>
</code></pre>
<pre><code>array([ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        1.,  1.,  1.,  1.,  1.,  1.,  1.])
</code></pre><p>Since weight matrices are typically very sparse, there is also a sparse weights matrix constructor:</p>
<pre><code class="lang-python">qW.sparse
</code></pre>
<pre><code>&lt;254x254 sparse matrix of type &apos;&lt;class &apos;numpy.float64&apos;&gt;&apos;
    with 1460 stored elements in Compressed Sparse Row format&gt;
</code></pre><pre><code class="lang-python">qW.pct_nonzero <span class="hljs-comment">#Percentage of nonzero neighbor counts</span>
</code></pre>
<pre><code>2.263004526009052
</code></pre><p>By default, PySAL assigns each observation an index according to the order in which the observation was read in. This means that, by default, all of the observations in the weights object are indexed by table order. If you have an alternative ID variable, you can pass that into the weights constructor. </p>
<p>For example, the <code>texas.shp</code> dataset has a possible alternative ID Variable, a <code>FIPS</code> code.</p>
<pre><code class="lang-python">gpd_df.head()
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>STATE_NAME</th>
      <th>STATE_FIPS</th>
      <th>CNTY_FIPS</th>
      <th>FIPS</th>
      <th>STFIPS</th>
      <th>COFIPS</th>
      <th>FIPSNO</th>
      <th>SOUTH</th>
      <th>HR60</th>
      <th>...</th>
      <th>BLK90</th>
      <th>GI59</th>
      <th>GI69</th>
      <th>GI79</th>
      <th>GI89</th>
      <th>FH60</th>
      <th>FH70</th>
      <th>FH80</th>
      <th>FH90</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lipscomb</td>
      <td>Texas</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.031817</td>
      <td>0.286929</td>
      <td>0.378219</td>
      <td>0.407005</td>
      <td>0.373005</td>
      <td>6.724512</td>
      <td>4.5</td>
      <td>3.835360</td>
      <td>6.093580</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee10&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sherman</td>
      <td>Texas</td>
      <td>48</td>
      <td>421</td>
      <td>48421</td>
      <td>48</td>
      <td>421</td>
      <td>48421</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.139958</td>
      <td>0.288976</td>
      <td>0.359377</td>
      <td>0.415453</td>
      <td>0.378041</td>
      <td>5.665722</td>
      <td>1.7</td>
      <td>3.253796</td>
      <td>3.869407</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee80&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dallam</td>
      <td>Texas</td>
      <td>48</td>
      <td>111</td>
      <td>48111</td>
      <td>48</td>
      <td>111</td>
      <td>48111</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>2.050906</td>
      <td>0.331667</td>
      <td>0.385996</td>
      <td>0.370037</td>
      <td>0.376015</td>
      <td>7.546049</td>
      <td>7.2</td>
      <td>9.471366</td>
      <td>14.231738</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91eef0&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hansford</td>
      <td>Texas</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.253527</td>
      <td>0.357813</td>
      <td>0.393938</td>
      <td>0.383924</td>
      <td>7.591786</td>
      <td>4.7</td>
      <td>5.542986</td>
      <td>7.125457</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ef60&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91efd0&gt;</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#xD7; 70 columns</p>
</div>



<p>The observation we were discussing above is in the fifth row: Ochiltree county, Texas. Note that its FIPS code is 48357.</p>
<p>Then, instead of indexing the weights and the dataframe just based on read-order, use the <code>FIPS</code> code as an index:</p>
<pre><code class="lang-python">gpd_df = gpd.read_file(shp_path)
qW = Queen.from_dataframe(gpd_df,idVariable=<span class="hljs-string">&apos;FIPS&apos;</span>)
</code></pre>
<pre><code class="lang-python">qW[<span class="hljs-number">4</span>] <span class="hljs-comment">#fails, since no FIPS is 4.</span>
</code></pre>
<pre><code>---------------------------------------------------------------------------

KeyError                                  Traceback (most recent call last)

&lt;ipython-input-21-1d8a3009bc1e&gt; in &lt;module&gt;()
----&gt; 1 qW[4] #fails, since no FIPS is 4.


/Users/dani/anaconda/envs/gds-scipy16/lib/python3.5/site-packages/pysal/weights/weights.py in __getitem__(self, key)
    504         {1: 1.0, 4: 1.0, 101: 1.0, 85: 1.0, 5: 1.0}
    505         &quot;&quot;&quot;
--&gt; 506         return dict(list(zip(self.neighbors[key], self.weights[key])))
    507 
    508     def __iter__(self):


KeyError: 4
</code></pre><p>Note that a <code>KeyError</code> in Python usually means that some index, here <code>4</code>, was not found in the collection being searched, the IDs in the queen weights object. This makes sense, since we explicitly passed an <code>idVariable</code> argument, and nothing has a <code>FIPS</code> code of 4.</p>
<p>Instead, if we use the observation&apos;s <code>FIPS</code> code:</p>
<pre><code class="lang-python">qW[<span class="hljs-string">&apos;48357&apos;</span>]
</code></pre>
<pre><code>{&apos;48195&apos;: 1.0, &apos;48211&apos;: 1.0, &apos;48233&apos;: 1.0, &apos;48295&apos;: 1.0, &apos;48393&apos;: 1.0}
</code></pre><p>We get what we need.</p>
<p>In addition, we have to now query the dataframe using the <code>FIPS</code> code to find our neighbors. But, this is relatively easy to do, since pandas will parse the query by looking into python objects, if told to. </p>
<p>First, let us store the neighbors of our target county:</p>
<pre><code class="lang-python">self_and_neighbors = [<span class="hljs-string">&apos;48357&apos;</span>]
self_and_neighbors.extend(qW.neighbors[<span class="hljs-string">&apos;48357&apos;</span>])
</code></pre>
<p>Then, we can use this list in <code>.query</code>: </p>
<pre><code class="lang-python">gpd_df.query(<span class="hljs-string">&apos;FIPS in @self_and_neighbors&apos;</span>)
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>STATE_NAME</th>
      <th>STATE_FIPS</th>
      <th>CNTY_FIPS</th>
      <th>FIPS</th>
      <th>STFIPS</th>
      <th>COFIPS</th>
      <th>FIPSNO</th>
      <th>SOUTH</th>
      <th>HR60</th>
      <th>...</th>
      <th>BLK90</th>
      <th>GI59</th>
      <th>GI69</th>
      <th>GI79</th>
      <th>GI89</th>
      <th>FH60</th>
      <th>FH70</th>
      <th>FH80</th>
      <th>FH90</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lipscomb</td>
      <td>Texas</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.031817</td>
      <td>0.286929</td>
      <td>0.378219</td>
      <td>0.407005</td>
      <td>0.373005</td>
      <td>6.724512</td>
      <td>4.5</td>
      <td>3.835360</td>
      <td>6.093580</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee10&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hansford</td>
      <td>Texas</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.253527</td>
      <td>0.357813</td>
      <td>0.393938</td>
      <td>0.383924</td>
      <td>7.591786</td>
      <td>4.7</td>
      <td>5.542986</td>
      <td>7.125457</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ef60&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91efd0&gt;</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Roberts</td>
      <td>Texas</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.320275</td>
      <td>0.318656</td>
      <td>0.398681</td>
      <td>0.339626</td>
      <td>5.762712</td>
      <td>5.3</td>
      <td>6.231454</td>
      <td>4.885993</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b080&gt;</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hemphill</td>
      <td>Texas</td>
      <td>48</td>
      <td>211</td>
      <td>48211</td>
      <td>48</td>
      <td>211</td>
      <td>48211</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.188172</td>
      <td>0.286707</td>
      <td>0.385605</td>
      <td>0.352996</td>
      <td>0.346318</td>
      <td>6.300115</td>
      <td>6.9</td>
      <td>6.451613</td>
      <td>6.330366</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b0f0&gt;</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Hutchinson</td>
      <td>Texas</td>
      <td>48</td>
      <td>233</td>
      <td>48233</td>
      <td>48</td>
      <td>233</td>
      <td>48233</td>
      <td>1</td>
      <td>1.936915</td>
      <td>...</td>
      <td>2.635369</td>
      <td>0.199287</td>
      <td>0.322579</td>
      <td>0.323864</td>
      <td>0.370207</td>
      <td>5.387316</td>
      <td>5.1</td>
      <td>6.222679</td>
      <td>8.484271</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b160&gt;</td>
    </tr>
  </tbody>
</table>
<p>6 rows &#xD7; 70 columns</p>
</div>



<p>Note that we have to use <code>@</code> before the name in order to show that we&apos;re referring to a python object and not a column in the dataframe. </p>
<pre><code class="lang-python"><span class="hljs-comment">#df.query(&apos;FIPS in self_and_neighbors&apos;) will fail because there is no column called &apos;self_and_neighbors&apos;</span>
</code></pre>
<p>Of course, we could also reindex the dataframe to use the same index as our weights:</p>
<pre><code class="lang-python">fips_frame = gpd_df.set_index(gpd_df.FIPS)
fips_frame.head()
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>STATE_NAME</th>
      <th>STATE_FIPS</th>
      <th>CNTY_FIPS</th>
      <th>FIPS</th>
      <th>STFIPS</th>
      <th>COFIPS</th>
      <th>FIPSNO</th>
      <th>SOUTH</th>
      <th>HR60</th>
      <th>...</th>
      <th>BLK90</th>
      <th>GI59</th>
      <th>GI69</th>
      <th>GI79</th>
      <th>GI89</th>
      <th>FH60</th>
      <th>FH70</th>
      <th>FH80</th>
      <th>FH90</th>
      <th>geometry</th>
    </tr>
    <tr>
      <th>FIPS</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48295</th>
      <td>Lipscomb</td>
      <td>Texas</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.031817</td>
      <td>0.286929</td>
      <td>0.378219</td>
      <td>0.407005</td>
      <td>0.373005</td>
      <td>6.724512</td>
      <td>4.5</td>
      <td>3.835360</td>
      <td>6.093580</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee10&gt;</td>
    </tr>
    <tr>
      <th>48421</th>
      <td>Sherman</td>
      <td>Texas</td>
      <td>48</td>
      <td>421</td>
      <td>48421</td>
      <td>48</td>
      <td>421</td>
      <td>48421</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.139958</td>
      <td>0.288976</td>
      <td>0.359377</td>
      <td>0.415453</td>
      <td>0.378041</td>
      <td>5.665722</td>
      <td>1.7</td>
      <td>3.253796</td>
      <td>3.869407</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee80&gt;</td>
    </tr>
    <tr>
      <th>48111</th>
      <td>Dallam</td>
      <td>Texas</td>
      <td>48</td>
      <td>111</td>
      <td>48111</td>
      <td>48</td>
      <td>111</td>
      <td>48111</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>2.050906</td>
      <td>0.331667</td>
      <td>0.385996</td>
      <td>0.370037</td>
      <td>0.376015</td>
      <td>7.546049</td>
      <td>7.2</td>
      <td>9.471366</td>
      <td>14.231738</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91eef0&gt;</td>
    </tr>
    <tr>
      <th>48195</th>
      <td>Hansford</td>
      <td>Texas</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.253527</td>
      <td>0.357813</td>
      <td>0.393938</td>
      <td>0.383924</td>
      <td>7.591786</td>
      <td>4.7</td>
      <td>5.542986</td>
      <td>7.125457</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ef60&gt;</td>
    </tr>
    <tr>
      <th>48357</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91efd0&gt;</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#xD7; 70 columns</p>
</div>



<p>Now that both are using the same weights, we can use the <code>.loc</code> indexer again:</p>
<pre><code class="lang-python">fips_frame.loc[self_and_neighbors]
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>STATE_NAME</th>
      <th>STATE_FIPS</th>
      <th>CNTY_FIPS</th>
      <th>FIPS</th>
      <th>STFIPS</th>
      <th>COFIPS</th>
      <th>FIPSNO</th>
      <th>SOUTH</th>
      <th>HR60</th>
      <th>...</th>
      <th>BLK90</th>
      <th>GI59</th>
      <th>GI69</th>
      <th>GI79</th>
      <th>GI89</th>
      <th>FH60</th>
      <th>FH70</th>
      <th>FH80</th>
      <th>FH90</th>
      <th>geometry</th>
    </tr>
    <tr>
      <th>FIPS</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48357</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91efd0&gt;</td>
    </tr>
    <tr>
      <th>48295</th>
      <td>Lipscomb</td>
      <td>Texas</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.031817</td>
      <td>0.286929</td>
      <td>0.378219</td>
      <td>0.407005</td>
      <td>0.373005</td>
      <td>6.724512</td>
      <td>4.5</td>
      <td>3.835360</td>
      <td>6.093580</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee10&gt;</td>
    </tr>
    <tr>
      <th>48195</th>
      <td>Hansford</td>
      <td>Texas</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.253527</td>
      <td>0.357813</td>
      <td>0.393938</td>
      <td>0.383924</td>
      <td>7.591786</td>
      <td>4.7</td>
      <td>5.542986</td>
      <td>7.125457</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ef60&gt;</td>
    </tr>
    <tr>
      <th>48393</th>
      <td>Roberts</td>
      <td>Texas</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.320275</td>
      <td>0.318656</td>
      <td>0.398681</td>
      <td>0.339626</td>
      <td>5.762712</td>
      <td>5.3</td>
      <td>6.231454</td>
      <td>4.885993</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b080&gt;</td>
    </tr>
    <tr>
      <th>48211</th>
      <td>Hemphill</td>
      <td>Texas</td>
      <td>48</td>
      <td>211</td>
      <td>48211</td>
      <td>48</td>
      <td>211</td>
      <td>48211</td>
      <td>1</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.188172</td>
      <td>0.286707</td>
      <td>0.385605</td>
      <td>0.352996</td>
      <td>0.346318</td>
      <td>6.300115</td>
      <td>6.9</td>
      <td>6.451613</td>
      <td>6.330366</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b0f0&gt;</td>
    </tr>
    <tr>
      <th>48233</th>
      <td>Hutchinson</td>
      <td>Texas</td>
      <td>48</td>
      <td>233</td>
      <td>48233</td>
      <td>48</td>
      <td>233</td>
      <td>48233</td>
      <td>1</td>
      <td>1.936915</td>
      <td>...</td>
      <td>2.635369</td>
      <td>0.199287</td>
      <td>0.322579</td>
      <td>0.323864</td>
      <td>0.370207</td>
      <td>5.387316</td>
      <td>5.1</td>
      <td>6.222679</td>
      <td>8.484271</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b160&gt;</td>
    </tr>
  </tbody>
</table>
<p>6 rows &#xD7; 70 columns</p>
</div>



<h4 id="rook-weights">Rook Weights</h4>
<p>Rook weights are another type of contiguity weight, but consider observations as neighboring only when they share an edge. The rook neighbors of an observation may be different than its queen neighbors, depending on how the observation and its nearby polygons are configured. </p>
<p>We can construct this in the same way as the queen weights, using the special <code>rook_from_shapefile</code> function:</p>
<pre><code class="lang-python">rW = Rook.from_dataframe(gpd_df,idVariable=<span class="hljs-string">&apos;FIPS&apos;</span>)
</code></pre>
<pre><code class="lang-python">rW[<span class="hljs-string">&apos;48357&apos;</span>]
</code></pre>
<pre><code>{&apos;48195&apos;: 1.0, &apos;48295&apos;: 1.0, &apos;48393&apos;: 1.0}
</code></pre><p>These weights function exactly like the Queen weights, and are only distinguished by what they consider &quot;neighbors.&quot;</p>
<pre><code class="lang-python">self_and_neighbors = [<span class="hljs-string">&apos;48357&apos;</span>]
self_and_neighbors.extend(rW.neighbors[<span class="hljs-string">&apos;48357&apos;</span>])
fips_frame.loc[self_and_neighbors]
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>STATE_NAME</th>
      <th>STATE_FIPS</th>
      <th>CNTY_FIPS</th>
      <th>FIPS</th>
      <th>STFIPS</th>
      <th>COFIPS</th>
      <th>FIPSNO</th>
      <th>SOUTH</th>
      <th>HR60</th>
      <th>...</th>
      <th>BLK90</th>
      <th>GI59</th>
      <th>GI69</th>
      <th>GI79</th>
      <th>GI89</th>
      <th>FH60</th>
      <th>FH70</th>
      <th>FH80</th>
      <th>FH90</th>
      <th>geometry</th>
    </tr>
    <tr>
      <th>FIPS</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48357</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91efd0&gt;</td>
    </tr>
    <tr>
      <th>48295</th>
      <td>Lipscomb</td>
      <td>Texas</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.031817</td>
      <td>0.286929</td>
      <td>0.378219</td>
      <td>0.407005</td>
      <td>0.373005</td>
      <td>6.724512</td>
      <td>4.5</td>
      <td>3.835360</td>
      <td>6.093580</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee10&gt;</td>
    </tr>
    <tr>
      <th>48195</th>
      <td>Hansford</td>
      <td>Texas</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.253527</td>
      <td>0.357813</td>
      <td>0.393938</td>
      <td>0.383924</td>
      <td>7.591786</td>
      <td>4.7</td>
      <td>5.542986</td>
      <td>7.125457</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ef60&gt;</td>
    </tr>
    <tr>
      <th>48393</th>
      <td>Roberts</td>
      <td>Texas</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.320275</td>
      <td>0.318656</td>
      <td>0.398681</td>
      <td>0.339626</td>
      <td>5.762712</td>
      <td>5.3</td>
      <td>6.231454</td>
      <td>4.885993</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91b080&gt;</td>
    </tr>
  </tbody>
</table>
<p>4 rows &#xD7; 70 columns</p>
</div>



<h4 id="bishop-weights">Bishop Weights</h4>
<p>In theory, a &quot;Bishop&quot; weighting scheme is one that arises when only polygons that share vertexes are considered to be neighboring. But, since Queen contiguigy requires either an edge or a vertex and Rook contiguity requires only shared edges, the following relationship is true:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">Q</mi></mrow><mo>=</mo><mrow><mi mathvariant="script">R</mi></mrow><mo>&#x222A;</mo><mrow><mi mathvariant="script">B</mi></mrow></mrow><annotation encoding="application/x-tex"> \mathcal{Q} = \mathcal{R} \cup \mathcal{B} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal">Q</span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathcal">R</span></span><span class="mbin">&#x222A;</span><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span></span></p>
<p>where $\mathcal{Q}$ is the set of neighbor pairs <em>via</em> queen contiguity, $\mathcal{R}$ is the set of neighbor pairs <em>via</em> Rook contiguity, and $\mathcal{B}$ <em>via</em> Bishop contiguity. Thus:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">Q</mi></mrow><mo>&#x2216;</mo><mrow><mi mathvariant="script">R</mi></mrow><mo>=</mo><mrow><mi mathvariant="script">B</mi></mrow></mrow><annotation encoding="application/x-tex"> \mathcal{Q} \setminus \mathcal{R} = \mathcal{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal">Q</span></span><span class="mbin">&#x2216;</span><span class="mord textstyle uncramped"><span class="mord mathcal">R</span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span></span></p>
<p>Bishop weights entail all Queen neighbor pairs that are not also Rook neighbors.</p>
<p>PySAL does not have a dedicated bishop weights constructor, but you can construct very easily using the <code>w_difference</code> function. This function is one of a family of tools to work with weights, all defined in <code>ps.weights</code>, that conduct these types of set operations between weight objects.</p>
<pre><code class="lang-python">bW = w_difference(qW, rW, constrained=<span class="hljs-keyword">False</span>)
</code></pre>
<pre><code class="lang-python">bW.histogram
</code></pre>
<pre><code>[(0, 161), (1, 48), (2, 33), (3, 8), (4, 4)]
</code></pre><p>Thus, the vast majority of counties have no bishop neighbors. But, a few do. A simple way to see these observations in the dataframe is to find all elements of the dataframe that are not &quot;islands,&quot; the term for an observation with no neighbors:</p>
<pre><code class="lang-python">islands = bW.islands
</code></pre>
<pre><code class="lang-python"><span class="hljs-comment"># Using `.head()` to limit the number of rows printed</span>
df.query(<span class="hljs-string">&apos;FIPS not in @islands&apos;</span>).head()
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>STATE_NAME</th>
      <th>STATE_FIPS</th>
      <th>CNTY_FIPS</th>
      <th>FIPS</th>
      <th>STFIPS</th>
      <th>COFIPS</th>
      <th>FIPSNO</th>
      <th>SOUTH</th>
      <th>HR60</th>
      <th>...</th>
      <th>BLK90</th>
      <th>GI59</th>
      <th>GI69</th>
      <th>GI79</th>
      <th>GI89</th>
      <th>FH60</th>
      <th>FH70</th>
      <th>FH80</th>
      <th>FH90</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lipscomb</td>
      <td>Texas</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>48</td>
      <td>295</td>
      <td>48295</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.031817</td>
      <td>0.286929</td>
      <td>0.378219</td>
      <td>0.407005</td>
      <td>0.373005</td>
      <td>6.724512</td>
      <td>4.5</td>
      <td>3.835360</td>
      <td>6.093580</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee10&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sherman</td>
      <td>Texas</td>
      <td>48</td>
      <td>421</td>
      <td>48421</td>
      <td>48</td>
      <td>421</td>
      <td>48421</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.139958</td>
      <td>0.288976</td>
      <td>0.359377</td>
      <td>0.415453</td>
      <td>0.378041</td>
      <td>5.665722</td>
      <td>1.7</td>
      <td>3.253796</td>
      <td>3.869407</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ee80&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dallam</td>
      <td>Texas</td>
      <td>48</td>
      <td>111</td>
      <td>48111</td>
      <td>48</td>
      <td>111</td>
      <td>48111</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>2.050906</td>
      <td>0.331667</td>
      <td>0.385996</td>
      <td>0.370037</td>
      <td>0.376015</td>
      <td>7.546049</td>
      <td>7.2</td>
      <td>9.471366</td>
      <td>14.231738</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91eef0&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hansford</td>
      <td>Texas</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.253527</td>
      <td>0.357813</td>
      <td>0.393938</td>
      <td>0.383924</td>
      <td>7.591786</td>
      <td>4.7</td>
      <td>5.542986</td>
      <td>7.125457</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91ef60&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x10d91efd0&gt;</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#xD7; 70 columns</p>
</div>



<h2 id="distance">Distance</h2>
<p>There are many other kinds of weighting functions in PySAL. Another separate type use a continuous measure of distance to define neighborhoods. </p>
<pre><code class="lang-python">radius = lps.cg.sphere.RADIUS_EARTH_MILES
radius
</code></pre>
<pre><code>3958.755865744055
</code></pre><pre><code class="lang-python"><span class="hljs-comment">#lps.weights.min_threshold_dist_from_shapefile?</span>
</code></pre>
<pre><code class="lang-python">
radius = lps.cg.sphere.RADIUS_EARTH_MILES
threshold = lps.weihgts.min_threshold_dist_from_shapefile(<span class="hljs-string">&apos;data/texas.shp&apos;</span>,radius) <span class="hljs-comment"># now in miles, maximum nearest neighbor distance between the n observations</span>
</code></pre>
<pre><code class="lang-python">threshold
</code></pre>
<pre><code>60.47758554135752
</code></pre><h3 id="knn-defined-weights">knn defined weights</h3>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> libpysal.weights <span class="hljs-keyword">import</span> KNN
knn4_bad = KNN.from_shapefile(<span class="hljs-string">&apos;data/texas.shp&apos;</span>, k=<span class="hljs-number">4</span>) <span class="hljs-comment"># ignore curvature of the earth</span>
</code></pre>
<pre><code class="lang-python">knn4_bad.histogram
</code></pre>
<pre><code>[(4, 254)]
</code></pre><pre><code class="lang-python">knn4 = KNN.from_shapefile(<span class="hljs-string">&apos;data/texas.shp&apos;</span>, k=<span class="hljs-number">4</span>, radius=radius)
</code></pre>
<pre><code class="lang-python">knn4.histogram
</code></pre>
<pre><code>[(4, 254)]
</code></pre><pre><code class="lang-python">knn4[<span class="hljs-number">0</span>]
</code></pre>
<pre><code>{3: 1.0, 4: 1.0, 5: 1.0, 6: 1.0}
</code></pre><pre><code class="lang-python">knn4_bad[<span class="hljs-number">0</span>]
</code></pre>
<pre><code>{4: 1.0, 5: 1.0, 6: 1.0, 13: 1.0}
</code></pre><h4 id="kernel-w">Kernel W</h4>
<p>Kernel Weights are continuous distance-based weights that use kernel densities to define the neighbor relationship.
Typically, they estimate a <code>bandwidth</code>, which is a parameter governing how far out observations should be considered neighboring. Then, using this bandwidth, they evaluate a continuous kernel function to provide a weight between 0 and 1.</p>
<p>Many different choices of kernel functions are supported, and bandwidths can either be fixed (constant over all units) or adaptive in function of unit density.</p>
<p>For example, if we want to use adaptive bandwidths for the map and weight according to a gaussian kernel:</p>
<pre><code class="lang-python">kernelWa = Kernel.from_dataframe(gpd_df, k=<span class="hljs-number">10</span>, fixed=<span class="hljs-keyword">False</span>, function=<span class="hljs-string">&apos;gaussian&apos;</span>)
kernelWa
</code></pre>
<pre><code>&lt;libpysal.weights.distance.DistanceBand at 0x7fea4e2183c8&gt;
</code></pre><pre><code class="lang-python">gpd_df.loc[kernelWa.neighbors[<span class="hljs-number">4</span>] + [<span class="hljs-number">4</span>]]
</code></pre>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>STATE_NAME</th>
      <th>STATE_FIPS</th>
      <th>CNTY_FIPS</th>
      <th>FIPS</th>
      <th>STFIPS</th>
      <th>COFIPS</th>
      <th>FIPSNO</th>
      <th>SOUTH</th>
      <th>HR60</th>
      <th>...</th>
      <th>BLK90</th>
      <th>GI59</th>
      <th>GI69</th>
      <th>GI79</th>
      <th>GI89</th>
      <th>FH60</th>
      <th>FH70</th>
      <th>FH80</th>
      <th>FH90</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x7f8fe4ee1...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Roberts</td>
      <td>Texas</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>48</td>
      <td>393</td>
      <td>48393</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.320275</td>
      <td>0.318656</td>
      <td>0.398681</td>
      <td>0.339626</td>
      <td>5.762712</td>
      <td>5.3</td>
      <td>6.231454</td>
      <td>4.885993</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x7f8fe4ee1...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hansford</td>
      <td>Texas</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>48</td>
      <td>195</td>
      <td>48195</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.253527</td>
      <td>0.357813</td>
      <td>0.393938</td>
      <td>0.383924</td>
      <td>7.591786</td>
      <td>4.7</td>
      <td>5.542986</td>
      <td>7.125457</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x7f8fe4ee1...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ochiltree</td>
      <td>Texas</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>48</td>
      <td>357</td>
      <td>48357</td>
      <td>1</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.021911</td>
      <td>0.236998</td>
      <td>0.352940</td>
      <td>0.343949</td>
      <td>0.374461</td>
      <td>5.172414</td>
      <td>4.0</td>
      <td>4.758392</td>
      <td>9.159159</td>
      <td>&lt;pysal.cg.shapes.Polygon object at 0x7f8fe4ee1...</td>
    </tr>
  </tbody>
</table>
<p>4 rows &#xD7; 70 columns</p>
</div>




<pre><code class="lang-python">kernelWa.bandwidth[<span class="hljs-number">0</span>:<span class="hljs-number">7</span>]
</code></pre>
<pre><code>array([[ 30.30546757],
       [ 30.05684855],
       [ 39.14876899],
       [ 29.96302462],
       [ 29.96302462],
       [ 30.21084447],
       [ 30.23619029]])
</code></pre><pre><code class="lang-python">kernelWa[<span class="hljs-number">4</span>]
</code></pre>
<pre><code>{3: 9.99999900663795e-08, 4: 1.0, 5: 0.002299013803371608}
</code></pre><pre><code class="lang-python">kernelWa[<span class="hljs-number">2</span>]
</code></pre>
<pre><code>{1: 9.99999900663795e-08, 2: 1.0, 8: 0.23409571720488287}
</code></pre><h2 id="distance-thresholds">Distance Thresholds</h2>
<pre><code class="lang-python"><span class="hljs-comment">#lps.weights.min_threshold_dist_from_shapefile?</span>
</code></pre>
<pre><code class="lang-python"><span class="hljs-comment"># find the largest nearest neighbor distance between centroids</span>
threshold = DistanceBand.from_shapefile(<span class="hljs-string">&apos;data/texas.shp&apos;</span>, threshold=radius) <span class="hljs-comment"># decimal degrees</span>
Wmind0 = threshold.binary
</code></pre>
<pre><code>WARNING: there are 2 disconnected observations
Island ids:  [133, 181]
</code></pre><pre><code class="lang-python">
Wmind = lps.weights.min_threshold_dist_from_shapefile(<span class="hljs-string">&apos;data/texas.shp&apos;</span>, radius=radius)
</code></pre>
<pre><code class="lang-python">centroids = np.vstack([gpd_df.centroid.x, gpd_df.centroid.y]).T
</code></pre>
<pre><code class="lang-python">centroids[<span class="hljs-number">0</span>:<span class="hljs-number">10</span>]
</code></pre>
<pre><code>array([[-100.27156111,   36.27508641],
       [-101.8930971 ,   36.27325425],
       [-102.59590795,   36.27354996],
       [-101.35351324,   36.27230422],
       [-100.81561379,   36.27317803],
       [-100.81482387,   35.8405153 ],
       [-100.2694824 ,   35.83996075],
       [-101.35420366,   35.8408377 ],
       [-102.59375964,   35.83958662],
       [-101.89248229,   35.84058246]])
</code></pre><pre><code class="lang-python">knn4[<span class="hljs-number">0</span>]
</code></pre>
<pre><code>{3: 1.0, 4: 1.0, 5: 1.0, 6: 1.0}
</code></pre><h2 id="visualization">Visualization</h2>
<pre><code class="lang-python">%matplotlib inline
<span class="hljs-keyword">import</span> geopandas <span class="hljs-keyword">as</span> gpd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
</code></pre>
<pre><code class="lang-python">shp_path = <span class="hljs-string">&apos;data/texas.shp&apos;</span>
gpd_shp = gpd.read_file(shp_path)
gpd_df =  gpd_shp.to_crs(<span class="hljs-number">3857</span>)   
wq = Queen.from_dataframe(gpd_df)
centroids = np.vstack([gpd_df.centroid.x, gpd_df.centroid.y]).T
</code></pre>
<pre><code class="lang-python">wq[<span class="hljs-number">0</span>]
</code></pre>
<pre><code>{4: 1.0, 5: 1.0, 6: 1.0}
</code></pre><pre><code class="lang-python">fig, ax = plt.subplots(<span class="hljs-number">1</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">8</span>))
centroids =pd.DataFrame(np.vstack([gpd_df.NAME, gpd_df.centroid.x, gpd_df.centroid.y]).T, columns=[<span class="hljs-string">&apos;name&apos;</span>, <span class="hljs-string">&apos;x&apos;</span>, <span class="hljs-string">&apos;y&apos;</span>])
centroids.plot(x=<span class="hljs-string">&apos;x&apos;</span>,y=<span class="hljs-string">&apos;y&apos;</span>,kind=<span class="hljs-string">&apos;scatter&apos;</span>,ax=ax,color=<span class="hljs-string">&apos;b&apos;</span>)
ax.set_axis_off()
plt.show()
</code></pre>
<p><img src="03_spatial_weights_files/03_spatial_weights_95_0.png" alt="png"></p>
<pre><code class="lang-python">wq.neighbors[<span class="hljs-number">0</span>]
</code></pre>
<pre><code>[4, 5, 6]
</code></pre><pre><code class="lang-python">
ax = gpd_df.plot(edgecolor=<span class="hljs-string">&apos;grey&apos;</span>, facecolor=<span class="hljs-string">&apos;w&apos;</span>)
fig,ax = wq.plot(gpd_df, ax=ax,
edge_kws=dict(color=<span class="hljs-string">&apos;r&apos;</span>, linestyle=<span class="hljs-string">&apos;:&apos;</span>, linewidth=<span class="hljs-number">1</span>),
node_kws=dict(marker=<span class="hljs-string">&apos;&apos;</span>))
ax.set_axis_off()
plt.title(<span class="hljs-string">&apos;Queen Neighbor Graph&apos;</span>)
plt.show()
</code></pre>
<p><img src="03_spatial_weights_files/03_spatial_weights_97_0.png" alt="png"></p>
<pre><code class="lang-python">wr = Rook.from_dataframe(gpd_df)
</code></pre>
<pre><code class="lang-python">ax = gpd_df.plot(edgecolor=<span class="hljs-string">&apos;grey&apos;</span>, facecolor=<span class="hljs-string">&apos;w&apos;</span>)
fig,ax = wr.plot(gpd_df, ax=ax,
edge_kws=dict(color=<span class="hljs-string">&apos;b&apos;</span>, linestyle=<span class="hljs-string">&apos;:&apos;</span>, linewidth=<span class="hljs-number">1</span>),
node_kws=dict(marker=<span class="hljs-string">&apos;&apos;</span>))
ax.set_axis_off()
plt.title(<span class="hljs-string">&apos;Rook Neighbor Graph&apos;</span>)
plt.show()
</code></pre>
<p><img src="03_spatial_weights_files/03_spatial_weights_99_0.png" alt="png"></p>
<pre><code class="lang-python">wf = lps.weights.fuzzy_contiguity(gpd_df)
</code></pre>
<pre><code class="lang-python">
ax = gpd_df.plot(edgecolor=<span class="hljs-string">&apos;grey&apos;</span>, facecolor=<span class="hljs-string">&apos;w&apos;</span>)
fig,ax = wf.plot(gpd_df, ax=ax,
edge_kws=dict(color=<span class="hljs-string">&apos;g&apos;</span>, linestyle=<span class="hljs-string">&apos;:&apos;</span>, linewidth=<span class="hljs-number">1</span>),
node_kws=dict(marker=<span class="hljs-string">&apos;&apos;</span>))
plt.title(<span class="hljs-string">&apos;Rio Grande do Sul: Nonplanar Weights&apos;</span>)
ax.set_axis_off()
plt.show()
</code></pre>
<p><img src="03_spatial_weights_files/03_spatial_weights_100_0.png" alt="png"></p>
<pre><code class="lang-python">wf.pct_nonzero
</code></pre>
<pre><code>3.8378076756153514
</code></pre><pre><code class="lang-python">wr.pct_nonzero
</code></pre>
<pre><code>2.0243040486080974
</code></pre><pre><code class="lang-python">wq.pct_nonzero
</code></pre>
<pre><code>2.263004526009052
</code></pre><h2 id="exercise">Exercise</h2>
<ol>
<li>Answer this question before writing any code: What spatial weights structure would be more dense, Texas counties based on rook contiguity or Texas counties based on knn with k=4?</li>
<li>Why?</li>
<li>Write code to see if you are correct.</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="02_geovisualization.html" class="navigation navigation-prev " aria-label="Previous page: Geovisualization">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="04_esda.html" class="navigation navigation-next " aria-label="Next page: ESDA with PySAL">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Spatial weights in PySAL","level":"1.7.3","depth":2,"next":{"title":"ESDA with PySAL","level":"1.7.4","depth":2,"path":"ipynb_md/04_esda.md","ref":"ipynb_md/04_esda.md","articles":[]},"previous":{"title":"Geovisualization","level":"1.7.2","depth":2,"path":"ipynb_md/02_geovisualization.md","ref":"ipynb_md/02_geovisualization.md","articles":[]},"dir":"ltr"},"config":{"plugins":["katex-dev"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"katex-dev":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Serif","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Geographic Data Science with PySAL and the pydata stack","gitbook":">=3.0.0","description":"Booklet with material for geospatial"},"file":{"path":"ipynb_md/03_spatial_weights.md","mtime":"2021-03-18T15:40:02.090Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-03-18T16:10:05.509Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

